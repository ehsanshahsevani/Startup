@inject CategoryService CategoryService
@inject RequestResultService RequestResultService

@if (Tags is not null)
{
    <TagViewer Tags="Tags"
               TagsSelected="@(TagsSelected)"
               ShowHeader="ShowHeader!.Value"
               OnSelectKey="args => OnSelectKey.InvokeAsync(args)"/>
}

@code {
    public Dictionary<string, string>? Tags { get; set; }

    [Parameter] public bool? ShowHeader { get; set; }
    
    [Parameter] public Dictionary<string, string>? TagsSelected { get; set; }
    [Parameter] public EventCallback<Dictionary<string, string>> OnSelectKey { get; set; }
    
    protected override async Task OnInitializedAsync()
    {
        if (ShowHeader.HasValue == false)
        {
            ShowHeader = true;
        }
        
        await SetTagsAsync();
    }

    private async Task SetTagsAsync()
    {
        var result = await CategoryService.GetTagsAsync();

        RequestResultService.AddResult(result);

        if (result.IsSuccess == true)
        {
            Tags = result.Value;
            StateHasChanged();
        }
    }
}